<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Import a module or package — importing • box</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><script src="../extra.js"></script><meta property="og:title" content="Import a module or package — importing"><meta name="description" content="Actual implementation of the import process"><meta property="og:description" content="Actual implementation of the import process"><meta property="og:image" content="https://klmr.me/box/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">box</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/box.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>General topics</h6></li>
    <li><a class="dropdown-item" href="../articles/faq.html">Frequently asked questions</a></li>
    <li><a class="dropdown-item" href="../articles/testing.html">Testing modules</a></li>
    <li><a class="dropdown-item" href="../articles/compiled-code.html">Using compiled code</a></li>
    <li><a class="dropdown-item" href="../articles/migration.html">Migration guide for version 1.0</a></li>
    <li><a class="dropdown-item" href="../articles/related.html">Similar packages</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Notes for developers</h6></li>
    <li><a class="dropdown-item" href="../articles/contributing.html">Contributing</a></li>
    <li><a class="dropdown-item" href="../articles/mod-envs.html">Module environments</a></li>
    <li><a class="dropdown-item" href="../articles/extract-benchmark.html">Module access benchmark</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/klmr/box/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Import a module or package</h1>
      <small class="dont-index">Source: <a href="https://github.com/klmr/box/blob/main/R/use.r" class="external-link"><code>R/use.r</code></a></small>
      <div class="d-none name"><code>importing.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Actual implementation of the import process</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">use_one</span><span class="op">(</span><span class="va">declaration</span>, <span class="va">alias</span>, <span class="va">caller</span>, <span class="va">use_call</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">load_and_register</span><span class="op">(</span><span class="va">spec</span>, <span class="va">info</span>, <span class="va">caller</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">register_as_import</span><span class="op">(</span><span class="va">spec</span>, <span class="va">info</span>, <span class="va">mod_ns</span>, <span class="va">caller</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">defer_import_finalization</span><span class="op">(</span><span class="va">spec</span>, <span class="va">info</span>, <span class="va">mod_ns</span>, <span class="va">caller</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">finalize_deferred</span><span class="op">(</span><span class="va">info</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">export_and_attach</span><span class="op">(</span><span class="va">spec</span>, <span class="va">info</span>, <span class="va">mod_ns</span>, <span class="va">caller</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">load_from_source</span><span class="op">(</span><span class="va">info</span>, <span class="va">mod_ns</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">load_mod</span><span class="op">(</span><span class="va">info</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mod_exports</span><span class="op">(</span><span class="va">info</span>, <span class="va">spec</span>, <span class="va">mod_ns</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mod_export_names</span><span class="op">(</span><span class="va">info</span>, <span class="va">mod_ns</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">attach_to_caller</span><span class="op">(</span><span class="va">spec</span>, <span class="va">info</span>, <span class="va">mod_exports</span>, <span class="va">mod_ns</span>, <span class="va">caller</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">attach_list</span><span class="op">(</span><span class="va">spec</span>, <span class="va">exports</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">assign_alias</span><span class="op">(</span><span class="va">spec</span>, <span class="va">mod_exports</span>, <span class="va">caller</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">assign_temp_alias</span><span class="op">(</span><span class="va">spec</span>, <span class="va">caller</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-declaration">declaration<a class="anchor" aria-label="anchor" href="#arg-declaration"></a></dt>
<dd><p>an unevaluated use declaration expression without the
surrounding <code>use</code> call</p></dd>


<dt id="arg-alias">alias<a class="anchor" aria-label="anchor" href="#arg-alias"></a></dt>
<dd><p>the use alias, if given, otherwise <code>NULL</code></p></dd>


<dt id="arg-caller">caller<a class="anchor" aria-label="anchor" href="#arg-caller"></a></dt>
<dd><p>the client’s calling environment (parent frame)</p></dd>


<dt id="arg-use-call">use_call<a class="anchor" aria-label="anchor" href="#arg-use-call"></a></dt>
<dd><p>the <code>use</code> call which is invoking this code</p></dd>


<dt id="arg-spec">spec<a class="anchor" aria-label="anchor" href="#arg-spec"></a></dt>
<dd><p>a module use declaration specification</p></dd>


<dt id="arg-info">info<a class="anchor" aria-label="anchor" href="#arg-info"></a></dt>
<dd><p>the physical module information</p></dd>


<dt id="arg-mod-ns">mod_ns<a class="anchor" aria-label="anchor" href="#arg-mod-ns"></a></dt>
<dd><p>the module namespace environment of the newly loaded module</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>use_one</code> does not currently return a value. — This might change
in the future.</p>
<p><code>load_mod</code> returns the module or package namespace environment
of the specified module or package info.</p>
<p><code>mod_exports</code> returns an export environment containing the
exported names of a given module.</p>
<p><code>mode_export_names</code> returns a vector containing the same names as
<code>names(mod_exports(info, spec, mod_ns))</code> but does not create an export
environment.</p>
<p><code>attach_list</code> returns a named character vector of the names in
an attach specification. The vector’s names are the aliases, if provided, or
the attach specification names themselves otherwise.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>use_one</code> performs the actual import. It is invoked by <code>use</code> given
the calling context and unevaluated expressions as arguments, and only uses
standard evaluation.</p>
<p><code>load_and_register</code> performs the loading, attaching and exporting of a
module identified by its spec and info.</p>
<p><code>register_as_import</code> registers a <code>use</code> declaration in the calling
module so that it can be found later on, if the declaration is reexported by
the calling module.</p>
<p><code>defer_import_finalization</code> is called by <code>load_and_register</code> to
earmark a module for deferred initialization if it hasn’t been fully loaded
yet.</p>
<p><code>finalize_deferred</code> exports and attaches names from a module use
declaration which has been deferred due to being part of a cyclic loading
chain.</p>
<p><code>export_and_attach</code> exports and attaches names from a given module use
declaration.</p>
<p><code>load_from_source</code> loads a module source file into its newly created,
empty module namespace.</p>
<p><code>load_mod</code> tests whether a module or package was already loaded and, if
not, loads it.</p>
<p><code>mod_exports</code> returns an export environment containing a copy of the
module’s exported objects.</p>
<p><code>attach_to_caller</code> attaches the listed names of an attach specification
for a given use declaration to the calling environment.</p>
<p><code>assign_alias</code> creates a module/package object in calling environment,
unless it contains an attach declaration, and no explicit alias is given.</p>
<p><code>assign_temp_alias</code> creates a placeholder object for the module in the
calling environment, to be replaced by the actual module export environment
once the module is completely loaded (which happens in the case of cyclic
imports).</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>If a module is still being loaded (because it is part of a cyclic
import chain), <code>load_and_register</code> earmarks the module for deferred
registration and holds off on attaching and exporting for now, since not all
its names are available yet.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://klmr.me" class="external-link">Konrad Rudolph</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000.</p>
</div>

    </footer></div>





  </body></html>

